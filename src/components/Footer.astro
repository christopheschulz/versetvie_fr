---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const currentYear = new Date().getFullYear();

// Localized paths for legal pages
const legalPaths = {
  fr: { privacy: '/fr/confidentialite', terms: '/fr/conditions' },
  en: { privacy: '/en/privacy', terms: '/en/terms' },
  de: { privacy: '/de/datenschutz', terms: '/de/nutzungsbedingungen' },
};
const paths = legalPaths[lang as keyof typeof legalPaths];

// Store URLs
const storeUrls = {
  appStore: 'https://apps.apple.com/app/versetvie/id6746123018',
  googlePlay: 'https://play.google.com/store/apps/details?id=com.anonymous.versetvie',
};

// Store badges by language
const badges = {
  appStore: `https://tools.applemediaservices.com/api/badges/download-on-the-app-store/black/${lang}-${lang}`,
  googlePlay: `https://play.google.com/intl/en_us/badges/static/images/badges/${lang}_badge_web_generic.png`,
};
---

<footer class="py-16 px-4 border-t border-[var(--color-border)] bg-[var(--color-surface)]/30">
  <div class="max-w-6xl mx-auto">
    <!-- Main Footer Content -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10 mb-12">

      <!-- Brand Column -->
      <div class="lg:col-span-1">
        <a href={`/${lang}/`} class="flex items-center gap-3 mb-4">
          <img src="/icon.png" alt="VersetVie" class="w-12 h-12 rounded-xl" />
          <span class="font-bold text-xl">VersetVie</span>
        </a>
        <p class="text-sm text-[var(--color-text-secondary)] mb-6 leading-relaxed">
          {t('footer.description')}
        </p>
        <!-- Contact Email -->
        <a
          href="mailto:contact@versetvie.fr"
          class="inline-flex items-center gap-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
          </svg>
          contact@versetvie.fr
        </a>
      </div>

      <!-- Navigation Column -->
      <div>
        <h3 class="font-semibold text-sm uppercase tracking-wider mb-4 text-[var(--color-text-tertiary)]">
          {t('footer.navigation')}
        </h3>
        <nav class="flex flex-col gap-3">
          <a href={`/${lang}/`} class="text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors">
            {t('nav.home')}
          </a>
          <a href={`/${lang}/#screenshots`} class="text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors">
            {t('nav.screenshots')}
          </a>
          <a href={`/${lang}/#features`} class="text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors">
            {t('nav.features')}
          </a>
          <a href={`/${lang}/#testimonials`} class="text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors">
            {t('nav.testimonials')}
          </a>
          <a href={`/${lang}/#faq`} class="text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors">
            FAQ
          </a>
        </nav>
      </div>

      <!-- Legal Column -->
      <div>
        <h3 class="font-semibold text-sm uppercase tracking-wider mb-4 text-[var(--color-text-tertiary)]">
          {t('footer.legal')}
        </h3>
        <nav class="flex flex-col gap-3">
          <a href={paths.privacy} class="text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors">
            {t('footer.privacy')}
          </a>
          <a href={paths.terms} class="text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] transition-colors">
            {t('footer.terms')}
          </a>
        </nav>
      </div>

      <!-- Download Column (CTA) -->
      <div>
        <h3 class="font-semibold text-sm uppercase tracking-wider mb-4 text-[var(--color-text-tertiary)]">
          {t('footer.download')}
        </h3>
        <div class="flex flex-col gap-3">
          <a
            href={storeUrls.appStore}
            target="_blank"
            rel="noopener noreferrer"
            class="transition-transform hover:scale-105"
          >
            <img
              src={badges.appStore}
              alt="App Store"
              class="h-10 w-auto"
              loading="lazy"
            />
          </a>
          <a
            href={storeUrls.googlePlay}
            target="_blank"
            rel="noopener noreferrer"
            class="transition-transform hover:scale-105"
          >
            <img
              src={badges.googlePlay}
              alt="Google Play"
              class="h-10 w-auto"
              loading="lazy"
            />
          </a>
        </div>
      </div>
    </div>

    <!-- Bottom Bar -->
    <div class="pt-8 border-t border-[var(--color-border)]">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <!-- Copyright -->
        <p class="text-sm text-[var(--color-text-tertiary)] text-center md:text-left">
          &copy; {currentYear} VersetVie. {t('footer.rights')}
        </p>

        <!-- Made By -->
        <p class="text-sm text-[var(--color-text-tertiary)]">
          {t('footer.madeBy')} <a href="https://codebykriss.fr" target="_blank" rel="noopener" class="text-[var(--color-primary)] hover:underline font-medium">Code By Kriss</a>
        </p>
      </div>
    </div>
  </div>
</footer>
